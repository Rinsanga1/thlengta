<section class="section" style="padding-top:46px;">
  <div style="max-width:1100px;margin:0 auto 20px;">
    <a class="btn" href="/superadmin/dashboard" style="width:auto;">← Back to Dashboard</a>
  </div>
  <div class="card pad super" style="max-width:1100px;margin:0 auto;">
    <div class="topbar" style="margin-bottom:14px;">
      <div>
        <div class="h-eyebrow">
          <span class="chip">Superadmin</span>
          <span class="chip">Upgrade Requests</span>
        </div>
        <h2 style="margin:10px 0 0;">Pending Upgrade Requests</h2>
        <div class="small" style="margin-top:6px;">Approve or reject plan upgrades.</div>
      </div>
    </div>

    <% if (msg) { %>
      <div class="notice" style="background:#eaf6f0;margin-bottom:12px;"><%= msg %></div>
    <% } %>

    <% if (error) { %>
      <div class="error"><%= error %></div>
    <% } %>

    <% if (!rows || !rows.length) { %>
      <div class="muted">No pending upgrade requests.</div>
    <% } else { %>
      <div class="list">
        <% rows.forEach(r => { %>
          <div class="item" style="align-items:flex-start;">
            <div class="icon">UP</div>
            <div style="flex:1;">
              <div style="font-weight:900;"><%= r.admin_email %></div>
              <div class="small" style="margin-top:6px;">
                <b><%= String(r.from_plan).toUpperCase() %></b>
                →
                <b><%= String(r.to_plan).toUpperCase() %></b>
                <span style="margin-left:10px;">Requested: <%= r.created_at %></span>
              </div>

              <div class="actions" style="margin-top:10px; display:flex; gap:10px; flex-wrap:wrap;">
                <form method="post" action="/superadmin/upgrade-requests/<%= r.id %>/approve">
                  <button class="btn primary" type="submit">Approve</button>
                </form>

                <form method="post" action="/superadmin/upgrade-requests/<%= r.id %>/reject" style="display:flex; gap:8px; align-items:center;">
                  <input name="note" placeholder="Reject note (optional)" style="max-width:260px;" />
                  <button class="btn" type="submit">Reject</button>
                </form>
              </div>
            </div>
          </div>
        <% }) %>
      </div>
    <% } %>

  </div>
</section>
